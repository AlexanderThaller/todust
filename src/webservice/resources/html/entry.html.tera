<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Todust - Entry - {{ entry.text | single_line | truncate(length=50) }}</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="/static/css/main.css">
    <link rel="stylesheet" href="/static/css/font-awesome.min.css">
  </head>

  <body>

    <a href="/project/{{ entry.metadata.project }}">back</a> |

    {% if entry.metadata.finished is some %}
    <a href="/api/v1/entry/mark/active/{{ entry.metadata.uuid }}">mark active</a>
    {% else %}
    <a href="/api/v1/entry/mark/done/{{ entry.metadata.uuid }}">mark done</a>
    {% endif %} |

    <a href="/entry/edit/{{ entry.metadata.uuid }}">edit</a> |
    <a href="/entry/move_project/{{ entry.metadata.uuid }}">move</a>

    <hr>

    <h1>Entry - {{ entry.text | single_line | truncate(length=50) }}</h1>

    <h2>Metadata</h2>
    <b>Project:</b> <a href="/project/{{ entry.metadata.project }}">{{ entry.metadata.project}}</a><br>
    <b>UUID:</b> {{ entry.metadata.uuid }}<br>
    <b>Last Change:</b> {{ entry.metadata.last_change }}<br>
    <b>Started:</b> {{ entry.metadata.started }}<br>
    <b>Active Duration:</b> {{ entry.metadata.started | format_duration_since }}<br>
    <b>Finished:</b> {{ entry.metadata.finished | some_or_dash }}<br>
    <b>Due:</b> {{ entry.metadata.due | some_or_dash }}

    <h2>Text</h2>
    {# SECURITY: We can use safe here as asciidoctor will already do the
    escaping. We would loos the html structure generated by asciidoctor if we
    would escape twice here #}
    {{ entry.text | safe | lines | asciidoc_header | asciidoc_to_html | safe }}

    <hr>

    <a href="/project/{{ entry.metadata.project }}">back</a> |

    {% if entry.metadata.finished is some %}
    <a href="/api/v1/entry/mark/active/{{ entry.metadata.uuid }}">mark active</a>
    {% else %}
    <a href="/api/v1/entry/mark/done/{{ entry.metadata.uuid }}">mark done</a>
    {% endif %} |

    <a href="/entry/edit/{{ entry.metadata.uuid }}">edit</a> |
    <a href="/entry/move_project/{{ entry.metadata.uuid }}">move</a>
  </body>
</html>
